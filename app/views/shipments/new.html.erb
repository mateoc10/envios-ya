<script src="//maps.google.com/maps/api/js?key=AIzaSyCULAfBJit219O85L4mwt4nqVhBL9KARCQ"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->

<% provide(:title, 'Sign up') %>
<h1>Shipment</h1>

<div class="row">
  <div class="col-md-6 col-md-offset-3">
    <%= form_for(@shipment, url: shipments_create_path) do |f| %>
      <%= f.label 'Destination user email' %>
      <%= f.text_field :destination %>
      
      <%= f.label :payment %>
      <%= f.select :payment, options_for_select([["I pay"], ["He pays"], ["Both"]]) %>
      
      <div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

      <%= f.submit "Create shipment", class: "btn btn-primary" %>
    <% end %>
  </div>
</div>

<script type='text/javascript'>
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      google.maps.event.addListener(handler.getMap(), 'click', function(latlng) {
        console.log('click', latlng);
        markers = handler.addMarkers([
          {
            "lat": -33.881689,
            "lng": -57.073897,
            "infowindow": "second!"
          }
        ]);
      });
      markers = handler.addMarkers([
        {
          "lat": -34.881689,
          "lng": -56.073897,
          "infowindow": "hello!"
        }
      ]);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
    });
    
</script>